<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookbook Detail - TKE Workshop</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Markdown æ¸²æŸ“æ”¯æŒ -->
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.0/marked.min.js"></script>
    
    <!-- ä»£ç é«˜äº®æ”¯æŒ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <style>
        :root {
            --bg-primary: #0f1419;
            --bg-secondary: #161b22;
            --bg-tertiary: #1c2128;
            --accent-blue: #1e88e5;
            --accent-purple: #9c27b0;
            --accent-cyan: #00bcd4;
            --accent-green: #4caf50;
            --accent-orange: #ff9800;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --border-color: #30363d;
            --card-hover: #21262d;
            --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* èƒŒæ™¯åŠ¨ç”» */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(156, 39, 176, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(0, 188, 212, 0.1) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        .grid-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
            background-image: 
                linear-gradient(rgba(102, 126, 234, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(102, 126, 234, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        /* è¿”å›æŒ‰é’® */
        .back-button {
            position: fixed;
            top: 2rem;
            left: 2rem;
            z-index: 1000;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--accent-blue);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-button:hover {
            background: var(--bg-tertiary);
            transform: translateX(-4px);
        }

        .back-button::before {
            content: 'â†';
            font-size: 1.25rem;
        }

        /* é¡µé¢å®¹å™¨ */
        .page-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            padding: 2rem;
            padding-top: 6rem;
        }

        .detail-layout {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 2rem;
        }

        /* å·¦ä¾§ä¸»å†…å®¹åŒº */
        .main-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        /* æ ‡é¢˜åŒºåŸŸ */
        .cookbook-header {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-bottom: 1px solid var(--border-color);
            padding: 2rem;
        }

        .cookbook-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .cookbook-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        .meta-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            color: var(--accent-blue);
        }

        .cookbook-summary {
            color: var(--text-secondary);
            font-size: 1.1rem;
            line-height: 1.8;
        }

        /* æ¶æ„å›¾åŒºåŸŸ */
        .architecture-section {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            border-bottom: 1px solid var(--border-color);
            padding: 3rem 2rem;
            position: relative;
        }

        .architecture-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, rgba(102, 126, 234, 0.05) 1px, transparent 1px),
                linear-gradient(rgba(102, 126, 234, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            position: relative;
            z-index: 1;
        }

        .architecture-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3rem;
            min-height: 200px;
            position: relative;
            z-index: 1;
        }

        .arch-component {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .arch-icon {
            width: 100px;
            height: 100px;
            background: var(--gradient-1);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 2rem;
            font-family: 'JetBrains Mono', monospace;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
            position: relative;
        }

        .arch-icon::after {
            content: '';
            position: absolute;
            inset: -3px;
            border-radius: 16px;
            padding: 3px;
            background: var(--gradient-1);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0.5;
        }

        .arch-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .arch-arrow {
            color: var(--accent-blue);
            font-size: 3rem;
            opacity: 0.7;
            font-family: 'JetBrains Mono', monospace;
        }

        /* README å†…å®¹åŒºåŸŸ */
        .readme-content {
            padding: 2rem;
        }

        .readme-loading {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }

        .readme-loading::before {
            content: 'â³';
            font-size: 3rem;
            display: block;
            margin-bottom: 1rem;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .readme-error {
            background: rgba(245, 87, 108, 0.1);
            border: 1px solid rgba(245, 87, 108, 0.3);
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem;
            color: #f5576c;
        }

        .readme-error::before {
            content: 'âš ï¸ ';
            font-size: 2rem;
        }

        /* Markdown æ ·å¼ */
        .markdown-body {
            color: var(--text-primary);
            font-size: 1rem;
            line-height: 1.8;
        }

        .markdown-body h1,
        .markdown-body h2,
        .markdown-body h3,
        .markdown-body h4,
        .markdown-body h5,
        .markdown-body h6 {
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.5rem;
        }

        .markdown-body h1 { font-size: 2rem; }
        .markdown-body h2 { font-size: 1.75rem; }
        .markdown-body h3 { font-size: 1.5rem; }
        .markdown-body h4 { font-size: 1.25rem; }

        .markdown-body p {
            margin-bottom: 1rem;
        }

        .markdown-body ul,
        .markdown-body ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        .markdown-body li {
            margin-bottom: 0.5rem;
        }

        .markdown-body code {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 0.2rem 0.4rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            color: var(--accent-cyan);
        }

        .markdown-body pre {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        .markdown-body pre code {
            background: none;
            border: none;
            padding: 0;
            color: var(--text-primary);
        }

        .markdown-body blockquote {
            border-left: 4px solid var(--accent-blue);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
        }

        .markdown-body img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .markdown-body a {
            color: var(--accent-blue);
            text-decoration: none;
            transition: color 0.3s;
        }

        .markdown-body a:hover {
            color: var(--accent-cyan);
            text-decoration: underline;
        }

        .markdown-body table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .markdown-body th,
        .markdown-body td {
            border: 1px solid var(--border-color);
            padding: 0.75rem;
            text-align: left;
        }

        .markdown-body th {
            background: var(--bg-tertiary);
            font-weight: 600;
        }

        /* å³ä¾§æ“ä½œé¢æ¿ */
        .action-panel {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            position: sticky;
            top: 2rem;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
        }

        .action-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .action-card-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .github-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--accent-blue);
            padding: 1rem;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
        }

        .github-link:hover {
            background: var(--card-hover);
            border-color: var(--accent-blue);
            transform: translateX(4px);
        }

        .github-link::before {
            content: 'ğŸ”—';
            font-size: 1.5rem;
        }

        .code-block {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            color: var(--text-secondary);
            overflow-x: auto;
            margin-bottom: 1rem;
            position: relative;
        }

        .code-block code {
            color: var(--accent-cyan);
            display: block;
            white-space: pre;
        }

        .copy-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.3);
            color: var(--accent-blue);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            transition: all 0.3s;
        }

        .copy-button:hover {
            background: rgba(102, 126, 234, 0.3);
        }

        .copy-button.copied {
            background: rgba(76, 175, 80, 0.2);
            border-color: rgba(76, 175, 80, 0.3);
            color: var(--accent-green);
        }

        .resource-list {
            list-style: none;
        }

        .resource-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            margin-bottom: 0.75rem;
            transition: all 0.3s;
        }

        .resource-item:hover {
            background: var(--card-hover);
        }

        .resource-item::before {
            content: 'ğŸ“„';
            font-size: 1.25rem;
        }

        .resource-item a {
            color: var(--accent-blue);
            text-decoration: none;
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
        }

        .resource-item a:hover {
            color: var(--accent-cyan);
            text-decoration: underline;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .detail-layout {
                grid-template-columns: 1fr;
            }

            .action-panel {
                position: static;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .page-container {
                padding: 1rem;
                padding-top: 5rem;
            }

            .back-button {
                top: 1rem;
                left: 1rem;
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }

            .cookbook-title {
                font-size: 2rem;
            }

            .architecture-diagram {
                flex-direction: column;
                gap: 2rem;
            }

            .arch-arrow {
                transform: rotate(90deg);
            }
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-blue);
        }
    </style>
</head>
<body>
    <!-- è¿”å›æŒ‰é’® -->
    <a href="cookbook-patterns.html" class="back-button" id="backButton">
        è¿”å›æ‰€æœ‰ Patterns
    </a>

    <!-- èƒŒæ™¯åŠ¨ç”» -->
    <div class="bg-animation"></div>
    <div class="grid-lines"></div>

    <div class="page-container">
        <div class="detail-layout">
            <!-- å·¦ä¾§ä¸»å†…å®¹ -->
            <div class="main-content">
                <!-- æ ‡é¢˜åŒºåŸŸ -->
                <div class="cookbook-header">
                    <h1 class="cookbook-title" id="cookbookTitle">Loading...</h1>
                    <div class="cookbook-meta" id="cookbookMeta">
                        <!-- Meta badges will be inserted here -->
                    </div>
                    <p class="cookbook-summary" id="cookbookSummary">
                        æ­£åœ¨åŠ è½½ Cookbook ä¿¡æ¯...
                    </p>
                </div>

                <!-- æ¶æ„å›¾åŒºåŸŸ -->
                <div class="architecture-section">
                    <h2 class="section-title">ğŸ“ æ¶æ„æµç¨‹</h2>
                    <div class="architecture-diagram" id="architectureDiagram">
                        <!-- Architecture diagram will be inserted here -->
                    </div>
                </div>

                <!-- README å†…å®¹ -->
                <div class="readme-content">
                    <h2 class="section-title">ğŸ“š è¯¦ç»†æ–‡æ¡£</h2>
                    <div id="readmeContent" class="readme-loading">
                        æ­£åœ¨åŠ è½½è¯¦ç»†æ–‡æ¡£...
                    </div>
                </div>
            </div>

            <!-- å³ä¾§æ“ä½œé¢æ¿ -->
            <aside class="action-panel">
                <!-- GitHub é“¾æ¥ -->
                <div class="action-card">
                    <h3 class="action-card-title">ğŸ”— GitHub ä»“åº“</h3>
                    <a href="#" id="githubLink" class="github-link" target="_blank">
                        è®¿é—® GitHub ä»“åº“
                    </a>
                </div>

                <!-- Download -->
                <div class="action-card">
                    <h3 class="action-card-title">â¬‡ï¸ Download</h3>
                    <div class="code-block" id="downloadCommand">
                        <button class="copy-button" onclick="copyCode('downloadCommand')">Copy</button>
                        <code>git clone [URL]</code>
                    </div>
                </div>

                <!-- Deploy -->
                <div class="action-card">
                    <h3 class="action-card-title">ğŸš€ Deploy</h3>
                    <div class="code-block" id="deployCommand">
                        <button class="copy-button" onclick="copyCode('deployCommand')">Copy</button>
                        <code># See README for deploy instructions</code>
                    </div>
                </div>

                <!-- Testing -->
                <div class="action-card">
                    <h3 class="action-card-title">ğŸ§ª Testing</h3>
                    <p style="color: var(--text-secondary); font-size: 0.95rem; margin-bottom: 1rem;">
                        å‚è€ƒ GitHub ä»“åº“ä¸­çš„è¯¦ç»†æµ‹è¯•è¯´æ˜ã€‚
                    </p>
                    <a href="#" id="testingLink" class="github-link" target="_blank" style="font-size: 0.875rem;">
                        æŸ¥çœ‹æµ‹è¯•æ–‡æ¡£
                    </a>
                </div>

                <!-- Cleanup -->
                <div class="action-card">
                    <h3 class="action-card-title">ğŸ§¹ Cleanup</h3>
                    <div class="code-block" id="cleanupCommand">
                        <button class="copy-button" onclick="copyCode('cleanupCommand')">Copy</button>
                        <code># See README for cleanup instructions</code>
                    </div>
                </div>

                <!-- Additional Resources -->
                <div class="action-card">
                    <h3 class="action-card-title">ğŸ“ Additional Resources</h3>
                    <ul class="resource-list" id="resourceList">
                        <li class="resource-item">
                            <a href="https://cloud.tencent.com/document/product/457" target="_blank">TKE å®˜æ–¹æ–‡æ¡£</a>
                        </li>
                        <li class="resource-item">
                            <a href="https://kubernetes.io/docs/" target="_blank">Kubernetes æ–‡æ¡£</a>
                        </li>
                    </ul>
                </div>
            </aside>
        </div>
    </div>

    <script>
        // ä» URL è·å– cookbook ID
        const urlParams = new URLSearchParams(window.location.search);
        const cookbookId = urlParams.get('id');

        // Cookbook æ•°æ®é…ç½® (ä» cookbook-patterns.html å¤åˆ¶)
        const cookbooks = [
            {
                id: 'create-cluster',
                title: 'åˆ›å»º TKE æ‰˜ç®¡é›†ç¾¤',
                category: 'cluster',
                language: 'Python',
                resources: [],
                tags: ['TKE API', 'VPC', 'Managed'],
                github: {
                    repo: 'tke-workshop/tke-workshop.github.io',
                    path: 'cookbook/cluster',
                    branch: 'main'
                },
                url: 'https://github.com/tke-workshop/tke-workshop.github.io/tree/main/cookbook/cluster',
                services: ['TKE', 'API']
            },
            {
                id: 'deploy-nginx',
                title: 'éƒ¨ç½² Nginx åº”ç”¨',
                category: 'workload',
                language: 'Python',
                resources: ['Deployment', 'Service'],
                tags: ['K8s', 'LB', 'Health'],
                github: {
                    repo: 'tke-workshop/tke-workshop.github.io',
                    path: 'cookbook/workload',
                    branch: 'main'
                },
                url: 'https://github.com/tke-workshop/tke-workshop.github.io/tree/main/cookbook/workload',
                services: ['DEP', 'SVC']
            },
            {
                id: 'deploy-gpu-pod',
                title: 'éƒ¨ç½² GPU å·¥ä½œè´Ÿè½½',
                category: 'gpu',
                language: 'Python',
                resources: ['Pod', 'SuperNode'],
                tags: ['GPU', 'AI/ML', 'Cache'],
                github: {
                    repo: 'tke-workshop/tke-workshop.github.io',
                    path: 'cookbook/supernode',
                    branch: 'main'
                },
                url: 'https://github.com/tke-workshop/tke-workshop.github.io/tree/main/cookbook/supernode',
                services: ['GPU', 'POD']
            },
            {
                id: 'tke-ai-playbook',
                title: 'TKE AI Playbook',
                category: 'gpu',
                language: 'YAML',
                resources: ['AI', 'ML'],
                tags: ['AI/ML', 'GPU', 'Training'],
                github: {
                    repo: 'tkestack/tke-playbook',
                    path: 'tke-ai-playbook',
                    branch: 'main'
                },
                url: 'https://github.com/tkestack/tke-playbook/tree/main/tke-ai-playbook',
                services: ['AI', 'TKE']
            },
            {
                id: 'tke-chaos-playbook',
                title: 'TKE Chaos Playbook',
                category: 'testing',
                language: 'YAML',
                resources: ['Chaos', 'Testing'],
                tags: ['Chaos', 'Fault', 'Resilience'],
                github: {
                    repo: 'tkestack/tke-playbook',
                    path: 'tke-chaos-playbook',
                    branch: 'main'
                },
                url: 'https://github.com/tkestack/tke-playbook/tree/main/tke-chaos-playbook',
                services: ['CHO', 'TST']
            },
            {
                id: 'tke-direct-upgrade',
                title: 'TKE Direct Upgrade',
                category: 'cluster',
                language: 'Bash',
                resources: ['Upgrade'],
                tags: ['Upgrade', 'Migration', 'Version'],
                github: {
                    repo: 'tkestack/tke-playbook',
                    path: 'tke-direct-upgrade',
                    branch: 'main'
                },
                url: 'https://github.com/tkestack/tke-playbook/tree/main/tke-direct-upgrade',
                services: ['TKE', 'UPG']
            },
            {
                id: 'tke-get-client-ip',
                title: 'TKE Get Client IP',
                category: 'networking',
                language: 'YAML',
                resources: ['Service', 'Ingress'],
                tags: ['Network', 'Client IP', 'LB'],
                github: {
                    repo: 'tkestack/tke-playbook',
                    path: 'tke-get-client-ip',
                    branch: 'main'
                },
                url: 'https://github.com/tkestack/tke-playbook/tree/main/tke-get-client-ip',
                services: ['NET', 'LB']
            },
            {
                id: 'tke-hybrid-node-architecture',
                title: 'TKE Hybrid Node Architecture',
                category: 'cluster',
                language: 'YAML',
                resources: ['Node', 'Architecture'],
                tags: ['Hybrid', 'Node', 'Multi-Arch'],
                github: {
                    repo: 'tkestack/tke-playbook',
                    path: 'tke-hybrid-node-architecture',
                    branch: 'main'
                },
                url: 'https://github.com/tkestack/tke-playbook/tree/main/tke-hybrid-node-architecture',
                services: ['NOD', 'ARC']
            },
            {
                id: 'tke-karpenter',
                title: 'TKE Karpenter',
                category: 'cluster',
                language: 'YAML',
                resources: ['Autoscaling', 'Node'],
                tags: ['Karpenter', 'Autoscaling', 'Node'],
                github: {
                    repo: 'tkestack/tke-playbook',
                    path: 'tke-karpenter',
                    branch: 'main'
                },
                url: 'https://github.com/tkestack/tke-playbook/tree/main/tke-karpenter',
                services: ['KAR', 'NOD']
            },
            {
                id: 'tke-terraform-examples',
                title: 'TKE Terraform Examples',
                category: 'cluster',
                language: 'Terraform',
                resources: ['IaC'],
                tags: ['Terraform', 'IaC', 'Automation'],
                github: {
                    repo: 'tkestack/tke-playbook',
                    path: 'tke-terraform-examples',
                    branch: 'main'
                },
                url: 'https://github.com/tkestack/tke-playbook/tree/main/tke-terraform-examples',
                services: ['TF', 'IAC']
            },
            {
                id: 'tke-to-community-ingress',
                title: 'TKE to Community Ingress',
                category: 'networking',
                language: 'YAML',
                resources: ['Ingress'],
                tags: ['Ingress', 'Migration', 'Community'],
                github: {
                    repo: 'tkestack/tke-playbook',
                    path: 'tke-to-community-ingress',
                    branch: 'main'
                },
                url: 'https://github.com/tkestack/tke-playbook/tree/main/tke-to-community-ingress',
                services: ['ING', 'NET']
            }
        ];

        // æŸ¥æ‰¾å½“å‰ cookbook
        const currentCookbook = cookbooks.find(c => c.id === cookbookId);

        if (!currentCookbook) {
            document.body.innerHTML = `
                <div style="text-align: center; padding: 4rem; color: var(--text-secondary);">
                    <h1 style="font-size: 3rem; margin-bottom: 1rem;">âŒ</h1>
                    <h2>Cookbook ä¸å­˜åœ¨</h2>
                    <p style="margin: 1rem 0;">æœªæ‰¾åˆ° ID ä¸º "${cookbookId}" çš„ Cookbook</p>
                    <a href="cookbook-patterns.html" style="color: var(--accent-blue);">è¿”å›åˆ—è¡¨</a>
                </div>
            `;
        } else {
            // æ¸²æŸ“é¡µé¢
            initializePage(currentCookbook);
        }

        /**
         * åˆå§‹åŒ–é¡µé¢
         */
        async function initializePage(cookbook) {
            // è®¾ç½®æ ‡é¢˜
            document.title = `${cookbook.title} - TKE Workshop`;
            document.getElementById('cookbookTitle').textContent = cookbook.title;

            // è®¾ç½® Meta æ ‡ç­¾
            const metaHtml = `
                <span class="meta-badge">
                    ğŸ“¦ ${getCategoryName(cookbook.category)}
                </span>
                <span class="meta-badge">
                    ğŸ’» ${cookbook.language}
                </span>
                ${cookbook.tags.map(tag => `
                    <span class="meta-badge">
                        ğŸ·ï¸ ${tag}
                    </span>
                `).join('')}
            `;
            document.getElementById('cookbookMeta').innerHTML = metaHtml;

            // è®¾ç½®æ¶æ„å›¾
            const diagramHtml = `
                <div class="arch-component">
                    <div class="arch-icon">${cookbook.services[0]}</div>
                    <div class="arch-label">${cookbook.services[0]}</div>
                </div>
                <div class="arch-arrow">â†’</div>
                <div class="arch-component">
                    <div class="arch-icon" style="background: var(--gradient-2);">${cookbook.services[1] || '?'}</div>
                    <div class="arch-label">${cookbook.services[1] || 'Service'}</div>
                </div>
            `;
            document.getElementById('architectureDiagram').innerHTML = diagramHtml;

            // è®¾ç½® GitHub é“¾æ¥
            document.getElementById('githubLink').href = cookbook.url;
            document.getElementById('testingLink').href = cookbook.url;

            // è®¾ç½®ä¸‹è½½å‘½ä»¤
            const cloneUrl = `https://github.com/${cookbook.github.repo}.git`;
            document.getElementById('downloadCommand').innerHTML = `
                <button class="copy-button" onclick="copyCode('downloadCommand')">Copy</button>
                <code>git clone ${cloneUrl}
cd ${cookbook.github.path}</code>
            `;

            // åŠ è½½ README
            await loadReadme(cookbook);
        }

        /**
         * ä» GitHub åŠ è½½ README
         */
        async function loadReadme(cookbook) {
            const { repo, path, branch = 'main' } = cookbook.github;
            const readmeUrl = `https://raw.githubusercontent.com/${repo}/${branch}/${path}/README.md`;

            try {
                const response = await fetch(readmeUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const markdownContent = await response.text();
                
                // æå– summary (å‰ 300 å­—ç¬¦)
                const summary = extractSummary(markdownContent);
                document.getElementById('cookbookSummary').textContent = summary;

                // æ¸²æŸ“å®Œæ•´ Markdown
                marked.setOptions({
                    highlight: function(code, lang) {
                        if (lang && hljs.getLanguage(lang)) {
                            return hljs.highlight(code, { language: lang }).value;
                        }
                        return hljs.highlightAuto(code).value;
                    },
                    breaks: true,
                    gfm: true
                });

                const htmlContent = marked.parse(markdownContent);
                document.getElementById('readmeContent').innerHTML = `<div class="markdown-body">${htmlContent}</div>`;

                // æå–éƒ¨ç½²å’Œæ¸…ç†å‘½ä»¤
                extractCommands(markdownContent);

            } catch (error) {
                console.error('Failed to load README:', error);
                document.getElementById('readmeContent').innerHTML = `
                    <div class="readme-error">
                        æ— æ³•åŠ è½½ README æ–‡æ¡£ã€‚<br>
                        é”™è¯¯: ${error.message}<br>
                        <a href="${cookbook.url}" target="_blank" style="color: #f5576c; text-decoration: underline;">
                            ç›´æ¥è®¿é—® GitHub æŸ¥çœ‹
                        </a>
                    </div>
                `;
                document.getElementById('cookbookSummary').textContent = 'æ— æ³•åŠ è½½æè¿°ã€‚è¯·è®¿é—® GitHub ä»“åº“æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ã€‚';
            }
        }

        /**
         * æå– README æ‘˜è¦
         */
        function extractSummary(markdown) {
            // ç§»é™¤æ ‡é¢˜ã€ä»£ç å—ã€é“¾æ¥
            let content = markdown
                .replace(/^#+\s+.*$/gm, '')
                .replace(/```[\s\S]*?```/g, '')
                .replace(/\[([^\]]+)\]\([^\)]+\)/g, '$1')
                .replace(/!\[([^\]]*)\]\([^\)]+\)/g, '')
                .replace(/<[^>]+>/g, '')
                .trim();

            // æå–å‰ 300 å­—ç¬¦
            const lines = content.split('\n').filter(line => line.trim().length > 20);
            let summary = '';
            
            for (const line of lines) {
                summary += line.trim() + ' ';
                if (summary.length > 300) break;
            }
            
            summary = summary.substring(0, 300).trim();
            if (summary.length === 300) {
                summary += '...';
            }
            
            return summary || 'æš‚æ— æè¿°ä¿¡æ¯ã€‚';
        }

        /**
         * æå–éƒ¨ç½²å’Œæ¸…ç†å‘½ä»¤
         */
        function extractCommands(markdown) {
            // æŸ¥æ‰¾ "Deploy" æˆ– "éƒ¨ç½²" ç›¸å…³çš„ä»£ç å—
            const deployMatch = markdown.match(/##\s*(Deploy|éƒ¨ç½²|Usage|ä½¿ç”¨)[\s\S]*?```(?:bash|sh)?\n([\s\S]*?)```/i);
            if (deployMatch && deployMatch[2]) {
                const deployCmd = deployMatch[2].trim();
                document.getElementById('deployCommand').innerHTML = `
                    <button class="copy-button" onclick="copyCode('deployCommand')">Copy</button>
                    <code>${escapeHtml(deployCmd)}</code>
                `;
            }

            // æŸ¥æ‰¾ "Cleanup" æˆ– "æ¸…ç†" ç›¸å…³çš„ä»£ç å—
            const cleanupMatch = markdown.match(/##\s*(Cleanup|æ¸…ç†|Delete|åˆ é™¤)[\s\S]*?```(?:bash|sh)?\n([\s\S]*?)```/i);
            if (cleanupMatch && cleanupMatch[2]) {
                const cleanupCmd = cleanupMatch[2].trim();
                document.getElementById('cleanupCommand').innerHTML = `
                    <button class="copy-button" onclick="copyCode('cleanupCommand')">Copy</button>
                    <code>${escapeHtml(cleanupCmd)}</code>
                `;
            }
        }

        /**
         * å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿
         */
        function copyCode(blockId) {
            const block = document.getElementById(blockId);
            const code = block.querySelector('code').textContent;
            const button = block.querySelector('.copy-button');

            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');

                setTimeout(() => {
                    button.textContent = 'Copy';
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
                button.textContent = 'Failed';
            });
        }

        /**
         * è¾…åŠ©å‡½æ•°
         */
        function getCategoryName(cat) {
            const names = {
                'cluster': 'é›†ç¾¤ç®¡ç†',
                'workload': 'å·¥ä½œè´Ÿè½½',
                'gpu': 'GPU/AI',
                'networking': 'ç½‘ç»œ',
                'storage': 'å­˜å‚¨',
                'testing': 'æµ‹è¯•'
            };
            return names[cat] || cat;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
